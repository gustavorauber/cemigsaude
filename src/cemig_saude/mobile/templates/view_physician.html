{% extends "index.html" %}

{% block header %}
<a href="/" data-icon="home">Início</a>
<h1>{{physician.get_name|title}}</h1>
{% endblock %}          

{% block content %}
<div class="ui-bar-c ui-corner-all ui-shadow" style="padding: 1em;">
    <table data-role="table" data-mode="reflow" id="physician-data">
        <thead>
	        <tr>
	           <th>Especialidade(s)</th>
	           <th>Registro Profissional</th>
	           <th>Telefone</th>
	           {% if self.get_email %}
	               <th>E-Mail</th>
	           {% endif %}
	           <th>Endereço</th>
	        </tr>
	    </thead>
	    <tbody>
	        <tr>
	           <td>{{physician.get_specialty|title}}</td>
	           <td>{{physician.get_register}}</td>
	           <td><a href="tel:{{physician.get_phone}}">{{physician.get_phone}}</a></td>
	           {% if self.get_email %}
	               <td><a href="mailto:{{physician.get_email}}">{{physician.get_email}}</a></td>
	           {% endif %}
	           <td><a href="geo:{{physician.get_lat}},{{physician.get_lon}};u=35">{{physician.get_street_address|title}}, {{physician.get_neighborhood}}, {{physician.get_city|title}}</a></td>
	        </tr>
	    </tbody>
    </table>
    <br />     
    <div id="map-canvas" style="height:400px;"></div>	
</div>
{% endblock %}    

{% block javascript %}
<script type="text/javascript">
$(document).bind("pageshow", function() {
	console.log('pageshow');
	
	var myLatlng = new google.maps.LatLng({{physician.get_lat}}, {{physician.get_lon}});
    var mapOptions = {
      zoom: 15,
      center: myLatlng
    };

    var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
    window.map = map;
    window.markers = [];

    var contentString = '<div>'+
        '<div id="siteNotice">'+
        '</div>'+
        '<h2 class="firstHeading">{{physician.get_name|title}}</h2>'+
        '<div>'+
        '<p><b>Especialidade(s)</b>: {{physician.get_specialty|title}} ' +
        '<p><b>Endereço</b>: {{physician.get_street_address|title}} ' +      
        '</div>'+
        '</div>';

    var infowindow = new google.maps.InfoWindow({
        content: contentString
    });

    var marker = new google.maps.Marker({
        position: myLatlng,
        map: map,
        title: '{{physician.get_name|title}}'
    });

    window.markers.push(marker);
    google.maps.event.addListener(marker, 'click', function() {
      infowindow.open(map,marker);
    });    
    
    infowindow.open(map, marker);
});
</script>    
{% endblock %}
